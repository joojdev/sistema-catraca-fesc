generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Tag {
  userId Int @id
  credential Int @unique
  released Boolean
  status String
  admin Boolean

  classes Class[]
  accesses Access[]

  @@map("tag")
  @@index(credential)
}

enum WeekDay {
  monday
  tuesday
  wednesday
  thursday
  friday
  saturday
  sunday
}

model Class {
  start Int
  weekDay WeekDay
  tagUserId Int

  tag Tag @relation(fields: [tagUserId], references: [userId])

  @@id([start, weekDay, tagUserId])

  @@map("class")
}

enum Status {
  granted
  revoked
  waiting
}

model Access {
  id String @id 
  timestamp DateTime
  tagUserId Int
  status Status @default(value: waiting)

  tag Tag @relation(fields: [tagUserId], references: [userId])

  @@map("access")
}